---
import type { CollectionEntry } from 'astro:content';
import { Header } from '@components/misc';
import FormattedDate from '@components/misc/formatted-date.astro';
import { BaseHead } from '@components/seo';
import RootLayout from '@layouts/root-layout.astro';
import { clsx } from '@utils/index';
import { Icon } from 'astro-icon/components';

type Props = CollectionEntry<'writing'>['data'] & {
	readingTime?: number;
	isOutdated?: boolean;
	yearsOld?: number;
};

const { title, description, pubDate, heroImage, readingTime, isOutdated, yearsOld } = Astro.props;
---

<html lang='en'>
	<head>
		<BaseHead
			title={title}
			description={description}
			image='/images/ogimage.png'
		/>
	</head>

	<RootLayout>
		<div
			id='navbar+title'
			class='flex flex-col w-full gap-6 max-w-2xl'>
			<Header />

			<article
				id='blog-content'
				class='w-full flex flex-col gap-6 items-center justify-center'>
				<h1
					class='w-full text-4xl md:text-5xl font-medium tracking-tight'>
					{title}
				</h1>
				<div class='flex flex-row gap-2 w-full'>
					<p class='text-start text-gray-500 font-medium'>
						<FormattedDate date={pubDate.toString()} />
					</p>
					<span class='text-gray-500 font-medium'>·</span>
					<p class='text-start text-gray-500 font-medium'>
						阅时约 {readingTime} 分
					</p>
				</div>
				{isOutdated && (
					<div class='w-full p-3 bg-amber-50 dark:bg-amber-950 border border-amber-200 dark:border-amber-800 rounded-lg'>
						<p class='font-medium text-sm md:text-base text-amber-800 dark:text-amber-200 flex items-center gap-3'>
							<Icon name="tabler:alert-triangle" class="w-5 h-5 flex-shrink-0" />
							<!-- <span> -->
							<!-- 	<span class='font-semibold'>时效性提醒：</span> -->
							<!-- 	本文发布于 {yearsOld} 年前，文中的部分信息可能已经过时或不再适用，请结合最新资料阅读。 -->
							<!-- </span> -->
            <span>
              <span class="font-semibold">时效性提醒：</span>
              本文写于 {yearsOld} 年前，基于当时的认知与背景。技术世界日新月异，在采纳文中观点时，敬请留意其时效性。
            </span>
            <!-- <span class="font-semibold"> -->
            <!--   <span>这是一次知识考古：</span> -->
            <!--   本文是 {yearsOld} 年前的一份记录。它或许已无法完全映射当下，但其思考的轨迹依然值得翻阅。 -->
            <!-- </span> -->
						</p>
					</div>
				)}
        <p
          class='w-full text-start font-medium text-gray-700 dark:text-gray-300 text-lg'>
          <span class='font-semibold text-gray-900 dark:text-white'
            >tl;dr:
          </span>
          {description}
        </p>
				<!-- we're using the Image component from Astro to handle the image optimization -->
				{
					heroImage && (
						<img
							src={heroImage}
							alt={title}
							class='w-full rounded-lg'
						/>
					)
				}
				<div
					class={clsx(
						'w-full prose md:prose-lg my-3 prose-p:font-medium dark:prose-invert prose-a:underline prose-a:bg-orange-50 prose-a:decoration-orange-500 items-center justify-center',
						'dark:prose-a:bg-orange-950 dark:prose-a:decoration-orange-400 dark:prose-a:underline',
						'prose-h1:font-medium prose-h2:font-medium prose-h3:font-medium prose-h4:font-medium prose-h5:font-medium prose-h6:font-medium',
						'prose-h1:tracking-tight prose-h2:tracking-tight prose-h3:tracking-tight prose-h4:tracking-tight prose-h5:tracking-tight prose-h6:tracking-tight',
						'prose-ul:font-medium prose-ol:font-medium prose-li:font-medium',
            'prose-ul:space-y-3 prose-ol:space-y-3 prose-li:space-y-3',
            'prose-pre:leading-5 prose-code:text-xs md:prose-code:text-sm'
					)}>
					<slot />
				</div>
			</article>
		</div>
	</RootLayout>
</html>
